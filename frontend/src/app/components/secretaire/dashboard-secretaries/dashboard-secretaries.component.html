<app-navbar></app-navbar>
<div class="dashboard-wrapper">
  <app-sidebar></app-sidebar>
  <div class="main-content">
    <div class="container">
      <h1>Tableau de bord des secrétaires</h1>
      <p>Gérez les rendez-vous du médecin assigné.</p>
      <div *ngIf="errorMessage" class="alert alert-danger">
        {{ errorMessage }}
      </div>
      <table class="table table-striped" *ngIf="appointments.length > 0; else noAppointments">
        <thead>
          <tr>
            <th>#</th>
            <th>Patient</th>
            <th>Date</th>
            <th>Heure</th>
            <th>Symptômes</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let appointment of appointments; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ appointment.patientName || 'Patient inconnu' }}</td>
            <td>{{ appointment.date | date: 'dd/MM/yyyy' }}</td>
            <td>{{ appointment.time }}</td>
            <td>
              <span *ngIf="appointment.symptoms && appointment.symptoms.length > 0">
                {{ appointment.symptoms[0].description }} (Intensité: {{ appointment.symptoms[0].intensity }}/10)
                <span *ngIf="appointment.symptoms.length > 1">...</span>
              </span>
              <span *ngIf="!appointment.symptoms || appointment.symptoms.length === 0">
                Aucun symptôme
              </span>
            </td>
            <td>
              <span [ngClass]="{
                'status-pending': appointment.status === 'en_attente',
                'status-confirmed': appointment.status === 'confirmé',
                'status-rejected': appointment.status === 'refusé'
              }">
                {{ appointment.status }}
              </span>
            </td>
            <td>
              <button *ngIf="appointment.status === 'en_attente'" (click)="confirmAppointment(appointment.id)" class="btn btn-success">
                Approuver
              </button>
              <button *ngIf="appointment.status === 'en_attente'" (click)="refuseAppointment(appointment.id)" class="btn btn-danger">
                Refuser
              </button>
            </td>
          </tr>
        </tbody>
      </table>
      <ng-template #noAppointments>
        <p>Aucun rendez-vous trouvé.</p>
      </ng-template>
    </div>
  </div>
</div>